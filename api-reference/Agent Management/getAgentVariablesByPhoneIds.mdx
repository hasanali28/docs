---
title: "Get Agent Variables by Phone"
description: "Resolve the variables required by agents linked to specific phone IDs."
openapi: "POST /api/agents/get-variables"
---

## Overview
When scheduling calls programmatically you can fetch the dynamic variables each agent expects based on the phone numbers you plan to use. This helps you shape call payloads before enqueuing them in a batch.

## Prerequisites
- Bearer token for the workspace admin.
- One or more phone IDs already linked to agents.

## Request
<ParamField header="Authorization" type="string" required>
Bearer token authorised to manage agents.
</ParamField>

<ParamField body="phoneId" type="array[string]" required>
List of phone IDs to resolve. Each ID returns the matching agent and its required variables.
</ParamField>

<RequestExample>
```bash cURL
curl --location '{{baseUrl}}/api/agents/get-variables' \
  --header 'Authorization: Bearer {{authToken}}' \
  --header 'Content-Type: application/json' \
  --data '{
    "phoneId": [
      "68ac46f39388e151abc5e388",
      "6853d286b819d90c0f6e77cc"
    ]
  }'
```
</RequestExample>

## Response
<ResponseExample>
```json 200 OK
{
  "success": true,
  "variables": [
    {
      "phoneId": "68ac46f39388e151abc5e388",
      "agentId": "684135442bc2d87ddfe0697f",
      "variables": ["customer_name", "loan_amount", "loan_tenure"]
    }
  ]
}
```
</ResponseExample>

<ResponseField name="variables" type="array" required>
Array of mappings that include the phone ID, linked agent ID, and list of variables that must be provided when creating calls.
</ResponseField>

## Error Handling
- **400 Bad Request** – No phone IDs supplied.
- **401 Unauthorized** – Bearer token missing or invalid.
- **404 Not Found** – None of the supplied phone IDs map to an agent.
- **500 Internal Server Error** – Nexus could not resolve the variables; retry with backoff.

<Tip>
Combine this endpoint with `POST /api/call/addCallsToBatch` to validate payloads before pushing them to the dialer.
</Tip>
